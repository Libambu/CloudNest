import{k as K,r as c,al as l,o as k,c as x,a as m,R as t,J as a,W as C,a6 as P,O as f,P as b,u as V,M as D,n as E}from"./@vue-d3a85cbd.js";import{u as H,b as J}from"./vue-router-ca350b6a.js";import{_ as W}from"./index-8cd997d5.js";import"./element-plus-01fea8a5.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-7b4dcecb.js";import"./@element-plus-8b4f8802.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-2cb15ffa.js";import"./aplayer-d80f7f58.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-1ce37bfe.js";import"./vue-cookies-191b1cbf.js";import"./@highlightjs-a8dc01e9.js";import"./highlight.js-a76881e7.js";import"./axios-b5ee139b.js";import"./docx-preview-30c6d22b.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-a25062db.js";import"./vue-9c0dbc85.js";import"./dplayer-ff9c2365.js";import"./vue-clipboard3-abb1cd37.js";import"./clipboard-2fdbe17c.js";const G={class:"top-panel"},Q={class:"file-list"},X={class:"avatar"},Y={key:0,style:{color:"#529b2e"}},Z={key:1,style:{color:"#f56c6c"}},ee=["onClick"],te=["onClick"],ae={__name:"UserList",setup(se){const{proxy:r}=K();H(),J();const S={loadDataList:"/admin/loadUserList",updateUserStatus:"/admin/updateUserStatus",updateUserSpace:"/admin/updateUserSpace"},N=[{label:"头像",prop:"avatar",width:80,scopedSlots:"avatar"},{label:"昵称",prop:"nickName"},{label:"邮箱",prop:"email"},{label:"空间使用",prop:"space",scopedSlots:"space"},{label:"加入时间",prop:"joinTime"},{label:"最后登录时间",prop:"lastLoginTime"},{label:"状态",prop:"status",scopedSlots:"status",width:80},{label:"操作",prop:"op",width:150,scopedSlots:"op"}],i=c({}),_=c({}),z={extHeight:20},d=async()=>{let s={pageNo:_.value.pageNo,pageSize:_.value.pageSize};Object.assign(s,i.value);let e=await r.Request({url:S.loadDataList,params:s});e&&(_.value=e.data)},L=s=>{r.Confirm(`你确定要【${s.status==0?"启动":"禁用"}】吗？`,async()=>{await r.Request({url:S.updateUserStatus,params:{userId:s.userId,status:s.status==0?1:0}})&&d()})},p=c({show:!1,title:"修改空间大小",buttons:[{type:"primary",text:"确定",click:s=>{q()}}]}),u=c({}),g=c(),R={changeSpace:[{required:!0,message:"请输入空间大小"}]},I=s=>{p.value.show=!0,E(()=>{g.value.resetFields(),u.value=Object.assign({},s)})},q=()=>{g.value.validate(async s=>{if(!s)return;let e={};Object.assign(e,u.value),await r.Request({url:S.updateUserSpace,params:e})&&(p.value.show=!1,r.Message.success("操作成功"),d())})};return(s,e)=>{const y=l("el-input"),v=l("el-form-item"),h=l("el-col"),w=l("el-option"),T=l("el-select"),F=l("el-button"),M=l("el-row"),U=l("el-form"),O=l("Avatar"),j=l("el-divider"),B=l("Table"),$=l("Dialog");return k(),x("div",null,[m("div",G,[t(U,{model:i.value,"label-width":"80px",onSubmit:e[2]||(e[2]=C(()=>{},["prevent"]))},{default:a(()=>[t(M,null,{default:a(()=>[t(h,{span:4},{default:a(()=>[t(v,{label:"用户昵称"},{default:a(()=>[t(y,{clearable:"",placeholder:"支持模糊搜索",modelValue:i.value.nickNameFuzzy,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.nickNameFuzzy=n),modelModifiers:{trim:!0},onKeyup:P(d,["native"])},null,8,["modelValue"])]),_:1})]),_:1}),t(h,{span:4},{default:a(()=>[t(v,{label:"状态"},{default:a(()=>[t(T,{clearable:"",placeholder:"请选择状态",modelValue:i.value.status,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.status=n)},{default:a(()=>[t(w,{value:1,label:"启用"}),t(w,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(h,{span:4,style:{"padding-left":"10px"}},{default:a(()=>[t(F,{type:"primary",onClick:d},{default:a(()=>e[6]||(e[6]=[f(" 查询 ",-1)])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["model"])]),m("div",Q,[t(B,{columns:N,showPagination:!0,dataSource:_.value,fetch:d,options:z},{avatar:a(({index:n,row:o})=>[m("div",X,[t(O,{userId:o.userId,avatar:o.qqAvatar},null,8,["userId","avatar"])])]),space:a(({index:n,row:o})=>[f(b(V(r).Utils.size2Str(o.useSpace))+"/"+b(V(r).Utils.size2Str(o.totalSpace)),1)]),status:a(({index:n,row:o})=>[o.status==1?(k(),x("span",Y,"启用")):D("",!0),o.status==0?(k(),x("span",Z,"禁用")):D("",!0)]),op:a(({index:n,row:o})=>[m("span",{class:"a-link",onClick:A=>I(o)},"分配空间",8,ee),t(j,{direction:"vertical"}),m("span",{class:"a-link",onClick:A=>L(o)},b(o.status==0?"启用":"禁用"),9,te)]),_:1},8,["dataSource"])]),t($,{show:p.value.show,title:p.value.title,buttons:p.value.buttons,width:"400px",showCancel:!1,onClose:e[5]||(e[5]=n=>p.value.show=!1)},{default:a(()=>[t(U,{model:u.value,rules:R,ref_key:"formDataRef",ref:g,"label-width":"80px",onSubmit:e[4]||(e[4]=C(()=>{},["prevent"]))},{default:a(()=>[t(v,{label:"昵称"},{default:a(()=>[f(b(u.value.nickName),1)]),_:1}),t(v,{label:"空间大小",prop:"changeSpace"},{default:a(()=>[t(y,{clearable:"",placeholder:"请输入空间大小",modelValue:u.value.changeSpace,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.changeSpace=n)},{suffix:a(()=>e[7]||(e[7]=[f("MB",-1)])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}},Le=W(ae,[["__scopeId","data-v-ad38efaa"]]);export{Le as default};
