import{u as L,b as M}from"./vue-router-ca350b6a.js";import{_ as V}from"./index-8cd997d5.js";import{k as E,r as g,al as _,o as a,c as p,a as s,R as v,J as u,O as S,I as y,Q as b,M as d,P as C,u as P}from"./@vue-d3a85cbd.js";import"./element-plus-01fea8a5.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-7b4dcecb.js";import"./@element-plus-8b4f8802.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-2cb15ffa.js";import"./aplayer-d80f7f58.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-1ce37bfe.js";import"./vue-cookies-191b1cbf.js";import"./@highlightjs-a8dc01e9.js";import"./highlight.js-a76881e7.js";import"./axios-b5ee139b.js";import"./docx-preview-30c6d22b.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-a25062db.js";import"./vue-9c0dbc85.js";import"./dplayer-ff9c2365.js";import"./vue-clipboard3-abb1cd37.js";import"./clipboard-2fdbe17c.js";const j={class:"top"},w={class:"file-list"},H=["onMouseenter","onMouseleave"],J=["title"],Q={class:"op"},U=["onClick"],A=["onClick"],G={key:0},K={__name:"Recycle",emits:["reload"],setup(W,{emit:N}){const{proxy:o}=E();L(),M();const n={loadDataList:"/recycle/loadRecycleList",delFile:"/recycle/delFile",recoverFile:"/recycle/recoverFile"},R=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"删除时间",prop:"recoveryTime",width:200},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",width:200}],r=g({}),T={extHeight:20,selectType:"checkbox"},c=async()=>{let e={pageNo:r.value.pageNo,pageSize:r.value.pageSize};e.category!=="all"&&delete e.filePid;let l=await o.Request({url:n.loadDataList,params:e});l&&(r.value=l.data)},I=e=>{r.value.list.forEach(l=>{l.showOp=!1}),e.showOp=!0},x=e=>{e.showOp=!1},i=g([]),F=e=>{i.value=[],e.forEach(l=>{i.value.push(l.fileId)})},z=e=>{o.Confirm(`你确定要还原【${e.fileName}】吗？`,async()=>{await o.Request({url:n.recoverFile,params:{fileIds:e.fileId}})&&c()})},O=()=>{i.value.length!=0&&o.Confirm("你确定要还原这些文件吗？",async()=>{await o.Request({url:n.recoverFile,params:{fileIds:i.value.join(",")}})&&c()})},h=N,B=e=>{o.Confirm(`你确定要删除【${e.fileName}】？`,async()=>{await o.Request({url:n.delFile,params:{fileIds:e.fileId}})&&(c(),h("reload"))})},$=e=>{i.value.length!=0&&o.Confirm("你确定要删除选中的文件?删除将无法恢复",async()=>{await o.Request({url:n.delFile,params:{fileIds:i.value.join(",")}})&&(c(),h("reload"))})};return(e,l)=>{const k=_("el-button"),f=_("icon"),q=_("Table");return a(),p("div",null,[s("div",j,[v(k,{type:"success",disabled:i.value.length==0,onClick:O},{default:u(()=>l[0]||(l[0]=[s("span",{class:"iconfont icon-revert"},null,-1),S("还原 ",-1)])),_:1,__:[0]},8,["disabled"]),v(k,{type:"danger",disabled:i.value.length==0,onClick:$},{default:u(()=>l[1]||(l[1]=[s("span",{class:"iconfont icon-del"},null,-1),S("批量删除 ",-1)])),_:1,__:[1]},8,["disabled"])]),s("div",w,[v(q,{columns:R,showPagination:!0,dataSource:r.value,fetch:c,options:T,onRowSelected:F},{fileName:u(({index:D,row:t})=>[s("div",{class:"file-item",onMouseenter:m=>I(t),onMouseleave:m=>x(t)},[(t.fileType==3||t.fileType==1)&&t.status!==0?(a(),y(f,{key:0,cover:t.fileCover},null,8,["cover"])):(a(),p(b,{key:1},[t.folderType==0?(a(),y(f,{key:0,fileType:t.fileType},null,8,["fileType"])):d("",!0),t.folderType==1?(a(),y(f,{key:1,fileType:0})):d("",!0)],64)),s("span",{class:"file-name",title:t.fileName},[s("span",null,C(t.fileName),1)],8,J),s("span",Q,[t.showOp&&t.fileId?(a(),p(b,{key:0},[s("span",{class:"iconfont icon-revert",onClick:m=>z(t)},"还原",8,U),s("span",{class:"iconfont icon-del",onClick:m=>B(t)},"删除",8,A)],64)):d("",!0)])],40,H)]),fileSize:u(({index:D,row:t})=>[t.fileSize?(a(),p("span",G,C(P(o).Utils.size2Str(t.fileSize)),1)):d("",!0)]),_:1},8,["dataSource"])])])}}},Ne=V(K,[["__scopeId","data-v-25de2ecd"]]);export{Ne as default};
