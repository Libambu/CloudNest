import{u as P}from"./vue-clipboard3-abb1cd37.js";import{u as q,b as w}from"./vue-router-ca350b6a.js";import{_ as z}from"./index-8cd997d5.js";import{k as j,r as c,al as h,o as s,c as r,a as o,R as T,J as _,O as k,I as f,Q as b,M as p,P as g}from"./@vue-d3a85cbd.js";import"./clipboard-2fdbe17c.js";import"./aplayer-d80f7f58.js";import"./element-plus-01fea8a5.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-7b4dcecb.js";import"./@element-plus-8b4f8802.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-2cb15ffa.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-1ce37bfe.js";import"./vue-cookies-191b1cbf.js";import"./@highlightjs-a8dc01e9.js";import"./highlight.js-a76881e7.js";import"./axios-b5ee139b.js";import"./docx-preview-30c6d22b.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-a25062db.js";import"./vue-9c0dbc85.js";import"./dplayer-ff9c2365.js";const F={class:"top"},H={class:"file-list"},J=["onMouseenter","onMouseleave"],Q=["title"],U={class:"op"},A=["onClick"],G=["onClick"],K={__name:"Share",setup(W){const{toClipboard:x}=P(),{proxy:l}=j();q(),w();const v={loadDataList:"/share/loadShareList",cancelShare:"/share/cancelShare"},C=c(document.location.origin+"/share/"),N=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],n=c({}),I={extHeight:20,selectType:"checkbox"},y=async()=>{let t={pageNo:n.value.pageNo,pageSize:n.value.pageSize};t.category!=="all"&&delete t.filePid;let a=await l.Request({url:v.loadDataList,params:t});a&&(n.value=a.data)},O=t=>{n.value.list.forEach(a=>{a.showOp=!1}),t.showOp=!0},M=t=>{t.showOp=!1},R=async t=>{await x(`链接:${C.value}${t.shareId} 提取码: ${t.code}`),l.Message.success("复制成功")},i=c([]),$=t=>{i.value=[],t.forEach(a=>{i.value.push(a.shareId)})},u=c([]),D=()=>{i.value.length!=0&&(u.value=i.value,S())},L=t=>{u.value=[t.shareId],S()},S=async()=>{l.Confirm("你确定要取消分享吗？",async()=>{await l.Request({url:v.cancelShare,params:{shareIds:u.value.join(",")}})&&(l.Message.success("取消分享成功"),y())})};return(t,a)=>{const B=h("el-button"),m=h("icon"),V=h("Table");return s(),r("div",null,[o("div",F,[T(B,{type:"primary",disabled:i.value.length==0,onClick:D},{default:_(()=>a[0]||(a[0]=[o("span",{class:"iconfont icon-cancel"},null,-1),k("取消分享 ",-1)])),_:1,__:[0]},8,["disabled"])]),o("div",H,[T(V,{columns:N,showPagination:!0,dataSource:n.value,fetch:y,options:I,onRowSelected:$},{fileName:_(({index:E,row:e})=>[o("div",{class:"file-item",onMouseenter:d=>O(e),onMouseleave:d=>M(e)},[(e.fileType==3||e.fileType==1)&&e.status!==0?(s(),f(m,{key:0,cover:e.fileCover},null,8,["cover"])):(s(),r(b,{key:1},[e.folderType==0?(s(),f(m,{key:0,fileType:e.fileType},null,8,["fileType"])):p("",!0),e.folderType==1?(s(),f(m,{key:1,fileType:0})):p("",!0)],64)),e.showRename?p("",!0):(s(),r("span",{key:2,class:"file-name",title:e.fileName},[o("span",null,g(e.fileName),1)],8,Q)),o("span",U,[e.showOp&&e.fileId?(s(),r(b,{key:0},[o("span",{class:"iconfont icon-link",onClick:d=>R(e)},"复制链接",8,A),o("span",{class:"iconfont icon-cancel",onClick:d=>L(e)},"取消分享",8,G)],64)):p("",!0)])],40,J)]),expireTime:_(({index:E,row:e})=>[k(g(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])}}},xe=z(K,[["__scopeId","data-v-8dfc0301"]]);export{xe as default};
